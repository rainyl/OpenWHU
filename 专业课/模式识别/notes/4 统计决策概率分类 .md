# 4 统计决策概率分类

[TOC]

## 研究对象

- 确定性事件（第三章
- 随机事件

## 概率知识

- 定义
- 性质
- 条件概率
  - 概率乘法公式
  - 全概率公式
  - 贝叶斯公式 $$P(A_i|B)=\frac{P(A_i)P(B|A_i)}{sum_{i=1}^{n}P(A_i)P(B|A_i)}$$
- 模式识别中三个概率
  - 先验概率 
  - 后验概率  $P(w_i|X)$
  - 条件概率 $P(X|w_i)$

## 贝叶斯决策

### 最小错误率贝叶斯决策

取后验概率中最大的

- 通过贝叶斯公式直接算后验概率

- 似然比决策 似然比$\frac{p(X|\omega_1 )}{p(X|\omega_2)}$ 似然比阈值 $\frac{P(\omega_2)}{P(\omega_1)}$

- 分母相同直接比较分子 $P(X|w_1)P(w_1)$和 $P(X|w_2)P(w_2)$

### 最小风险贝叶斯决策

- 风险（平均损失

​	 $$r_i(X)=\sum_{j=1}^{M}L_{ij}(X)P(w_j|X)$$ （j类样本划分到i类中

可化简为  $$r_i(X)=\sum_{j=1}^{M}L_{ij}(X)P(X|w_j)P(w_j)$$

- 步骤

  1. 定义损失函数$L_{ij}$

  2. 计算似然比阈值$$\theta_{12}=\frac{(L_{12}-L_{22})P(w_2)}{(L_{21}-L_{11})P(w_1)}$$
  3. 计算似然比$$l_{12}(X)=\frac{p(X|w_1)}{p(X|w_2)}$$
  4. 分类

- 0-1损失

  ​	等价于最小错误率贝叶斯决策

### 正态分布模式贝叶斯决策

- 最小错误率贝叶斯决策的判别函数

​	$$p(X|\omega_i)=\frac{1}{(2\pi)^{n/2}|C_i|^{1/2}}\exp\{ {-\frac{1}{2}(X-M_i)}^TC_i^{-1}(X-M_i)\}$$

​	$$C_i=E[(X-M)(X-M)^T]$$为协方差矩阵 $M_i=E_i[X]$为均值

- 对数简化后形式

  $$d_i(X)=lnP(\omega_i)-\frac{1}{2}ln|C_i|-\frac{1}{2}\{(X-M_i)^TC_i^{-1}(X-M_i)\}$$

- 最小错误率两类问题

  - $C_1\neq C_2$ 直接比较$d_1$ $d_2$

  - $C_1=C_2=C$

     $$d_1(X)-d_2(X)=ln P ( \omega_1 ) -ln P ( \omega_ 2 ) +( M_1-M_2)^TC^{-1}X-\frac{1}{2}M_1^TC^{-1}M_1+\frac{1}{2}M_2^TC^{-1}M_2$$

  - $C_1=C_2=I$且$P(\omega_1)=P(\omega_2)=\frac{1}{2}$

    $$d_1(X)-d_2(X)=(M_1-M_2)^TX-\frac{1}{2}(M_1^TM_1-M_2^TM_2)$$

- $M_i={1\over N_i}\sum_{j=1}^{N_i}X_{ij}$
- $$C_i={1\over N_i}\sum_{j=1}^{N_i}X_{ij}X_{ij}^T-M_iM_i^T$$

## 贝叶斯分类器错误率

### 错误率

- 定义：样本被错分的概率

  $$P(e)=\int_{-\infty}^{\infty}P(e|X)p(X)dX$$

- 两类问题
- 正态分布

  - 对数似然比 $h(X)=-\frac{1}{2}(X-M_1)^TC^{-1}(X-M_1)+\frac{1}{2}(X-M_2)^TC^{-1}(X-M_2)$

### 错误率估计

- 已设计好分类器

  - 未知先验概率 随机抽样

    $$\hat{\varepsilon}=\frac{k}{N}$$

  - 已知先验概率 选择抽样

    根据先验概率按比例取样，通过联合概率求错误率的最大似然估计

- 未设计好分类器
  - 要求：根据样本设计好分类器并估计性能（错误率）
  - 做法：将样本划分成设计样本集和检验样本集
    - 对半分
    - 留一法：每次样本剩一个，多次计算

## 耐曼-皮尔逊决策

### 目的

某一类的错误比另一类更为重要

### 基本思想

二类问题：限制某一类错误率为确定值，求使另一类错误率最小的判决规则和判决阈值

等价于其中一个为常数的条件下，求另一错误率极小值的条件极值问题

### 决策规则

$\frac {p(X|\omega_1)}{p(X|\omega_2)}>\mu$ 则 $x\in\omega_1$  

$\frac {p(X|\omega_1)}{p(X|\omega_2)}<\mu$ 则 $x\in\omega_2$

$\mu$为似然比阈值

### 计算流程

1. 利用正态求概率密度

2. 求似然比

3. 求似然比阈值 

   通过确定某一个错误率为常数，根据标准正态表查得判别界面$\mu$

4. 比较

## 概率密度估计

- 估计求解$P(X|\omega_i)$

- 参数估计方法：已知形式未知参数

  - 最大似然估计
    1. 似然函数 $p(X^N|\theta)=\prod_{k=1}^np(X_k|\theta)$
    2. 似然函数对数求导，可求得$\theta$最大似然估计值

  - 贝叶斯估计 将未知参数当随机参数考虑
    1. 确定先验概率密度$p(\theta)$
    2. 求似然函数$p(X^N|\theta)$
    3. 贝叶斯公式求后验概率密度$p(\theta|X^N)$
    4. 求贝叶斯估计量 $\hat{\theta}=\int\theta p(\theta|X^N)d\theta$

- 非参数估计

  未知形式